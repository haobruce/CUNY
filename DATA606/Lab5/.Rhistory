ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
theme_dark()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
theme_base()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
theme_()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
theme_bw()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
theme_excel()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
theme_gray()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_color_brewer()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_color_brewer(palette = 'Blues')
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_colour_brewer(palette = 'Blues')
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_brewer()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_excel()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_continuous_tableau()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_economist()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_identity()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_identity(guide = 'none')
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_identity() + coord_equal()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_brewer(palette = 'Set1')
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
#scale_fill_brewer(palette = 'Set1')
scale_fill_economist()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
#scale_fill_brewer(palette = 'Set1')
scale_fill_fivethirtyeight()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
#scale_fill_brewer(palette = 'Set1')
scale_fill_gradient_tableau()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
#scale_fill_brewer(palette = 'Set1')
scale_fill_grey()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
#scale_fill_brewer(palette = 'Set1')
scale_fill_solarized()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
#scale_fill_brewer(palette = 'Set1')
scale_fill_ptol()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
#scale_fill_brewer(palette = 'Set1')
scale_fill_pander()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
#scale_fill_brewer(palette = 'Set1')
scale_fill_tableau()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
#scale_fill_brewer(palette = 'Set1')
scale_fill_wsj()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_economist()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline, airport) %>%
summarise(OnTimePct = sum(`on time`) / sum(total), Total = sum(total)) %>%
ggplot(aes(x = airport, y = OnTimePct, fill = airline, width = Total/5000)) +
geom_bar(stat = 'identity') +
geom_text(aes(label = format(OnTimePct, digits = 2), color = airline), position = position_dodge(width=0.75), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1)) +
scale_fill_economist()
airlines %>%
gather(airport, flights, -(1:2)) %>%
spread(status, flights) %>%
mutate('total' = delayed + `on time`) %>%
group_by(airline) %>%
summarise(OnTimePct = sum(`on time`) / sum(total)) %>%
ggplot(aes(x = airline, y = OnTimePct, fill = airline)) +
geom_bar(stat = 'identity', width = 0.5) +
geom_text(aes(label = format(OnTimePct, digits = 2)), vjust = -0.25) +
scale_y_continuous(limits = c(0, 1))
pnorm(1.65)
pnorm(-1.65)
pnorm(1.96)
pnorm(1.96) - pnorm(-1.96)
setwd("~/Google Drive/CUNY/git/DATA606/Lab5")
library(IS606)
qnorm(0.05)
n = 25
z = qnorm((1 - 0.9) / 2)
z
qnorm(.95)
(1+.95)/2
qnorm((1+.95)/2)
n = 25
z = qnorm((1 + 0.9) / 2)  # using right tail to keep z positive
mu = (65 + 77) /2
n = 25
z = qnorm((1 + 0.9) / 2)  # using right tail to keep z positive
z
mu = (65 + 77) /2
mu
sd = (77 - mu) / z
sd
paste('+/-', moe)
moe = z * sd
paste('+/-', moe)
n = 25
z = qnorm((1 + 0.9) / 2)  # using right tail to keep z positive
z
mu = (65 + 77) /2
mu
sd = (77 - mu) / z
sd
moe = z * sd
paste('+/-', moe)
19*19
qnorm(.975)
(qnorm(.975)*10)^2
sd = 250
moe = 25
z = qnorm(0.95)
z = qnorm(0.95)
n = (z * sd / moe)^2
n
sd = 250
moe = 25
z = qnorm(0.995)
n = (z * sd / moe)^2
n
n = 200
mu = -0.545
sig = 8.887
se = sig / sqrt(n)
t = mu / se
t
pt(t)
qt(t)
n = 200
mu = -0.545
sig = 8.887
se = sig / sqrt(n)
t = mu / se
df = n - 1
qt(t, df)
n = 200
mu = -0.545
sig = 8.887
se = sig / sqrt(n)
t = abs(mu / se)
df = n - 1
qt(t, df)
n = 200
mu = -0.545
sig = 8.887
se = sig / sqrt(n)
t = mu / se
df = n - 1
pt(t, df)
se_norm = sig / sqrt(n)
mu / se_norm
pnorm(mu / se_norm)
mu_diff = 16.12 - 19.85
sd1 = 3.58
sd2 = 4.51
n1 = 26
n2 = 26
se = sqrt(sd1^2 / n1 + sd2^2 / n2)
t = mu_diff / se
df = 26 - 1
pt(t, df)
pnorm(t)
mu_diff = 16.12 - 19.85
sd1 = 3.58
sd2 = 4.51
n1 = 26
n2 = 26
se = sqrt(sd1^2 / n1 + sd2^2 / n2)
t = mu_diff / se
df = min(n1, n2) - 1
pt(t, df)
data.frame('' = c('degree', 'Residuals', 'Total'), 'Df' = c(2, 10, 12))
data.frame(' ' = c('degree', 'Residuals', 'Total'), 'Df' = c(2, 10, 12))
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1))
.4080/323
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382))
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382/ (n - k), 501.54 + 267382 / (n - k)))
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382/ (n - k), 501.54 + 267382 / (n - k)),
'Fvalue' = c(1))
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382/ (n - k), 501.54 + 267382 / (n - k)),
'Fvalue' = c(1,))
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382/ (n - k), 501.54 + 267382 / (n - k)),
'Fvalue' = c(1,'',''))
645.06/185.16
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382 / (n - k), 501.54 + 267382 / (n - k)),
'Fvalue' = c(501.54 / (267382 / (n - k)),'',''))
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382 / (n - k), 501.54 + 267382 / (n - k)),
'Fvalue' = c(round(501.54 / (267382 / (n - k)), 4),'',''))
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382 / (n - k), 501.54 + 267382 / (n - k)),
'Fvalue' = c(round(501.54 / (267382 / (n - k)), 5),'',''))
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382 / (n - k), 501.54 + 267382 / (n - k)),
'Fvalue' = c(round(501.54 / (267382 / (n - k)), 4),'',''))
?qf
1 - pf(2.189, 4, 1167)
qf(0.0682, 4, 1167)
pf(0.0682, 4, 1167)
qf(0.0682, 4, 1167, lower.tail = F)
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382 / (n - k), 501.54 + 267382 / (n - k)),
'Fvalue' = c(round(501.54 / (267382 / (n - k)), 4),'',''),
'Fcheck' = c(qf(0.0682, k - 1, n - k, lower.tail = F),'',''),
'Pr(>F)' = c(0.0682,'',''))
k = 5
n = 1172
data.frame('stat' = c('degree', 'Residuals', 'Total'),
'Df' = c(k - 1, n - k, n - 1),
'SumSq' = c(501.54 * (k - 1), 267382, 501.54* (k - 1) + 267382),
'MeanSq' = c(501.54, 267382 / (n - k), 501.54 + 267382 / (n - k)),
'Fvalue' = c(round(501.54 / (267382 / (n - k)), 4),'',''),
'Fcheck' = c(round(qf(0.0682, k - 1, n - k, lower.tail = F), 4),'',''),
'Pr(>F)' = c(0.0682,'',''))
